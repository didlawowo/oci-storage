persistentVolumesClaims:
- name: oci-storage-data
  accessModes:
  - ReadWriteOnce
  storageClassName: longhorn
  size: 30Gi

ingress:
  host: oci-storage.dc-tech.work
  tls:
    enabled: true
    secretName: "wildcard-dc"
  ingressClassName: traefik

env:
- name: ENV
  value: home
# Logging configuration
- name: LOG_LEVEL
  value: "info"
- name: LOG_FORMAT
  value: "text" # "text" avec couleurs ou "json"
# Auth configuration - Option 1: Variable unique avec liste
- name: HELM_USERS
  value: "admin:secret123,dev:devpass,readonly:readpass"

# envFrom:
# - secretRef:
#   name: oci-storage-backup

config:
  server:
    port: 3030
  storage:
    path: "data"
  backup:
    enabled: false
    provider: "gcp" # "aws" ou "gcp"
    gcp:
      bucket: "oci-storage-backup"
      projectID: "dc-consulting-home"
    # aws:
    #   bucket: "oci-storage-backup"
    #   region: "eu-west-1"
  logging:
    level: "info"
    format: "json"

# Désactivé - utilise externalSecrets à la place
secrets:
  dotenv: []
  files: []

# External Secrets avec Pulumi ESC
externalSecrets:
  enabled: true
  secrets:
  - name: auth
    store: pulumi-store
    refreshInterval: 1h
    template:
      type: Opaque
      data:
        auth.yaml: |
          auth:
            users:
            - username: "admin"
              password: "{{ .adminPassword }}"
    keys:
    - name: adminPassword
      remoteKey: oci-storage-password
